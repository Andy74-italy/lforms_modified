<script type="text/ng-template" id="cne-template">
  <div ng-switch on="item.displayControl.answerLayout">
    <div ng-switch-when="list">
      <label ng-repeat="answer in item.answers">
        <input type="checkbox" ng-if="item._multipleAnswers" ng-click="toggleCheckbox(item, answer)">
        <input type="radio" ng-model="item.value" ng-value="answer" ng-if="!item._multipleAnswers">
        {{answer.text}}
      </label>
    </div>

    <div ng-switch-when="combo">
      <input name="{{item.question +'_'+ $id}}" type="text"
             ng-required="item._answerRequired"
             ng-model="item.value" autocomplete-lhc="item._autocompOptions"
             ng-readonly="item._readOnly" placeholder="{{item._toolTip}}"
             id="{{item._elementId}}">
    </div>

    <!--default is 'combo'-->
    <div ng-switch-default>
      <input name="{{item.question +'_'+ $id}}" type="text"
             ng-required="item._answerRequired"
             ng-model="item.value" autocomplete-lhc="item._autocompOptions"
             ng-readonly="item._readOnly" placeholder="{{item._toolTip}}"
             id="{{item._elementId}}">
    </div>

  </div>
</script>

<script type="text/ng-template" id="cwe-template">
  <div ng-switch on="item.displayControl.answerLayout">

    <div ng-switch-when="list">
      <label ng-repeat="answer in item.answers">
        <input type="checkbox" ng-if="item._multipleAnswers" ng-click="toggleCheckbox(item, answer)">
        <input type="radio" ng-model="item.value" ng-value="answer" ng-if="!item._multipleAnswers">
        {{answer.text}}
      </label>

      <label ng-if="item._multipleAnswers">
        <input type="checkbox" ng-click="toggleCheckbox(item, {'code':item.valueOther,'text':item.valueOther})">
        OTHER:
      </label>
      <label ng-if="item._multipleAnswers"><input type="text" ng-model="item.valueOther"></label>

      <label ng-if="!item._multipleAnswers">
        <input type="radio" ng-model="item.value" ng-value="{'code':item.valueOther,'text':item.valueOther}">
        OTHER:
      </label>
      <label ng-if="!item._multipleAnswers"><input type="text" ng-model="item.valueOther"></label>
    </div>

    <!--default is 'combo'-->
    <div ng-switch-default>
      <input name="{{item.question +'_'+ $id}}" type="text"
             ng-required="item._answerRequired"
             ng-model="item.value" autocomplete-lhc="item._autocompOptions"
             ng-readonly="item._readOnly" placeholder="{{item._toolTip}}"
             id="{{item._elementId}}">
    </div>

  </div>
</script>

<script type="text/ng-template" id="item-template">
  <!--question-->
  <div class="name-label">
    <span ng-show="item._questionRepeatable" class="sn">{{getRepeatingSN(item) }}</span>
    <span><label for="{{item._elementId}}">{{item.question}}</label></span>
    <span class="item-code" ng-show="lfData.templateOptions.showQuestionCode">
      <a ng-if="item._linkToDef" href="{{ item._linkToDef }}" target="_blank">[{{ item.questionCode }}]</a>
      <span ng-if="!item._linkToDef">[{{ item.questionCode }}]</span>
    </span>
    <span ng-switch on="getCodingInstructionsDisplayType(item)">
      <span ng-switch-when="inline-html" class="prompt" ng-bind-html="getTrustedCodingInstructions(item)"></span>
      <span ng-switch-when="inline-escaped" class="prompt" ng-bind="item.codingInstructions"></span>
      <button ng-switch-when="popover-html" class="help-button" uib-popover-template="'popover.html'"
              popover-trigger="focus" popover-placement="right"  popover-title="Instruction"
              type="button" id="help-{{item._elementId}}">?</button>
      <button ng-switch-when="popover-escaped" class="help-button" uib-popover="{{item.codingInstructions}}"
              popover-trigger="focus" popover-placement="right"  popover-title="Instruction"
              type="button" id="help-{{item._elementId}}">?</button>
    </span>
    <button ng-if="item.copyrightNotice" id="copyright-{{item._elementId}}" type="button"
            class="copyright-button" uib-popover="{{item.copyrightNotice}}"
            popover-trigger="focus" popover-placement="right" popover-title="Copyright">&#9400;</button>
    <!--buttons-->
    <!--<div class="button-col">-->
      <button ng-if="!hasOneRepeatingItem(item)" class="float-button"
              ng-click="removeOneRepeatingItem(item)" id="del-{{item._elementId}}"
              type="button" title="Remove this '{{ item.question }}'">-</button>
    <!--</div>-->
  </div>
  <ng-form name="innerForm2" class="hasTooltip">
    <div class="lf-form-item-data tooltipContainer" ng-switch on="item.dataType">
      <span class="tooltipContent" ng-include="'validation.html'"></span>  <!-- validation error messages -->
      <span ng-switch-when="SECTION" id="{{item._elementId}}"> </span>
      <span ng-switch-when="TTILE" id="{{item._elementId}}"> </span>

      <!--<input ng-switch-when="CNE" name="{{item.question +'_'+ $id}}"-->
             <!--ng-required="item._answerRequired"-->
             <!--ng-model="item.value" autocomplete-lhc="item._autocompOptions"-->
             <!--ng-readonly="item._readOnly" placeholder="{{item._toolTip}}"-->
             <!--id="{{item._elementId}}">-->
      <!--<input ng-switch-when="CWE" name="{{item.question +'_'+ $id}}"-->
             <!--ng-required="item._answerRequired"-->
             <!--ng-model="item.value" autocomplete-lhc="item._autocompOptions"-->
             <!--ng-readonly="item._readOnly" placeholder="{{item._toolTip}}"-->
             <!--id="{{item._elementId}}">-->
      <div ng-switch-when="CNE">
        <div ng-include="'cne-template'"></div>
      </div>
      <div ng-switch-when="CWE">
        <div ng-include="'cwe-template'"></div>
      </div>
      <input ng-switch-when="REAL" name="{{item.question}}" type="number"
             ng-required="item._answerRequired"
             ng-model="item.value" placeholder="{{item._toolTip}}"
             ng-readonly="item._readOnly" id="{{item._elementId}}">
      <input ng-switch-when="INT" name="{{item.question}}" type="number"
             ng-required="item._answerRequired"
             ng-model="item.value" placeholder="{{item._toolTip}}"
             ng-readonly="item._readOnly" id="{{item._elementId}}">
      <input ng-switch-when="DT" name="{{item.question}}" ng-required="item._answerRequired" type="text"
             ng-model="item.value" lf-date="dateOptions" placeholder="{{item._toolTip}}"
             ng-readonly="item._readOnly" id="{{item._elementId}}">
      <textarea ng-switch-when="TX" name="{{item.question}}" ng-required="item._answerRequired"
                ng-model="item.value" placeholder="{{item._toolTip}}" ng-readonly="item._readOnly"
                id="{{item._elementId}}" ng-keyup="autoExpand($event)" ng-blur="autoExpand($event)" rows="1">
      </textarea>
      <input ng-switch-default name="{{item.question}}" ng-required="item._answerRequired" type="text"
             ng-model="item.value" placeholder="{{item._toolTip}}" ng-readonly="item._readOnly"
             id="{{item._elementId}}">
    </div>
  </ng-form>
  <div ng-switch on="checkUnits(item)">
    <input class="units" ng-switch-when="list" type="text"
           ng-model="item.unit" autocomplete-lhc="item._unitAutocompOptions"
           placeholder="Select one" aria-labelledby="th_Units">
    <span ng-switch-when="none" > </span>
  </div>

  <div ng-if="needExtra(item) && targetShown(item)" ng-click="setActiveRow(item)"
       class="extra-row {{getRowClass(item)}} {{getSkipLogicClass(item)}} {{getActiveRowClass(item)}}">
    <input ng-model="item.valueOther" placeholder="Please specify" ng-readonly="item._readOnly">
  </div>


  <div ng-if="item.items" class="section">
    <div ng-repeat="item in item.items" ng-if="targetShown(item)"
         class="data-row has-ng-animate {{getRowClass(item)}} {{getSkipLogicClass(item)}} {{getActiveRowClass(item)}}"
         ng-include="'item-template'">
    </div>
    <!--a button at the end of each repeating section-->
    <div ng-if="item._lastRepeatingItem && targetShown(item)"
         class="button-row {{getRowClass(item)}} {{getSkipLogicClass(item)}}">
      <div class="name-label has-popover-warning">
        <button type="button"
                class="float-button" id="add-{{item._elementId}}"
                title="Add another '{{ item.question }}'"
                ng-click="addOneRepeatingItem(item)"
                ng-blur="hideUnusedItemWarning(item)"
                uib-popover='Please enter info in the blank "{{ item.question }}".'
                popover-placement="top-left" popover-title="Warning"
                popover-trigger="none"
                popover-is-open="item._showUnusedItemWarning">
          Add another '{{item.question}}'
        </button>
      </div>
    </div>
  </div>

  <!--&lt;!&ndash;a button row at the end of each repeating section&ndash;&gt;-->
  <!--<div ng-if="item._repeatingSectionList && targetShown(item)"-->
       <!--class="button-row {{getRowClass(item)}} {{getSkipLogicClass(item)}}">-->
    <!--<div class="name-label has-popover-warning">-->
      <!--<button ng-repeat="repeatingItem in item._repeatingSectionList" type="button"-->
              <!--class="float-button" id="add-{{repeatingItem._elementId}}"-->
              <!--title="Add another '{{ repeatingItem.question }}'"-->
              <!--ng-click="addOneRepeatingItem(repeatingItem)"-->
              <!--ng-blur="hideUnusedItemWarning(repeatingItem)"-->
              <!--uib-popover='Please enter info in the blank "{{ repeatingItem.question }}".'-->
              <!--popover-placement="top-left" popover-title="Warning"-->
              <!--popover-trigger="none"-->
              <!--popover-is-open="repeatingItem._showUnusedItemWarning">-->
        <!--Add another '{{repeatingItem.question}}'-->
      <!--</button>-->
    <!--</div>-->
  <!--</div>-->

</script>


<form class="lf-form template-list" novalidate autocomplete="false">
  <div class="lf-form-view" ng-if="lfData">
    <div class="lf-form-header" ng-include="'form-header.html'"></div>

    <h3 class="lf-form-title">
      <span>{{lfData.name}}</span>
      <span class="item-code" ng-if="lfData.templateOptions.showQuestionCode">
        <a ng-if="lfData._linkToDef" href="{{ lfData._linkToDef }}" target="_blank">[{{ lfData.code }}]</a>
        <span ng-if="!lfData._linkToDef">[{{ lfData.code }}]</span>
      </span>
      <button ng-if="lfData.copyrightNotice" id="copyright-{{lfData.code}}" type="button"
              class="copyright-button" uib-popover="{{lfData.copyrightNotice}}"
              popover-trigger="focus" popover-placement="right" popover-title="Copyright">&#9400;</button>
    </h3>

    <div class="lf-form-body">
      <!-- data row -->
      <div ng-if="lfData.items" class="section">
        <div ng-repeat="item in lfData.items" ng-if="targetShown(item)"
             class="data-row has-ng-animate {{getRowClass(item)}} {{getSkipLogicClass(item)}} {{getActiveRowClass(item)}}"
             ng-include="'item-template'">
        </div>
      </div>
    </div>
  </div>
</form>

<button type="button" ng-if="debug" ng-click="onclick()">Click to debug Panel Controller</button>
