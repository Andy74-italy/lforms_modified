<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width">
  <title>LForms Next</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
  
<body>

  <div id="lforms-form">
    <div class="panel panel-default">
      <h3 class="panel-heading">LForms-Next Test Page</h3>
      <div class="panel-body">
        <p>Select a form from the list and click the button to display the form:</p>
          <select id="form-list" class="form-control">
            <option value="">--- Please Select ---</option>            
          </select>
        <br><br>
        <button id="load-form-data" class="btn btn-success" onclick="useForm()">Load Form</button>
        <select id="fhirVersion">
          <option value="R4">R4</option>
          <option value="STU3">STU3</option>
        </select>
        <button id="change-option" class="btn btn-primary" onclick="toggleCodingInstructionFormat()">Toggle Coding Instructions Format</button>
        <button id="toggle-units-col" class="btn btn-primary" onclick="toggleUnitsCol()">Hide/Show Units Column</button>
        <button id="reset-form-with-same-data" class="btn btn-primary" onclick="getFormDefDataAndResetForm()">Reset Form(using form data retrieved from form)</button>
        <button id="get-hl7" class="btn btn-primary" onclick="showHL7Segments()">Show HL7 OBR/OBX Segments</button>
        <button id="get-fhir" class="btn btn-primary" onclick="showFHIRResource()">Show FHIR DiagnosticReport Content</button>
        <button id="get-fhir-bundle1" class="btn btn-primary" onclick="showFHIRResourceBundle1()">Show FHIR DiagnosticReport in "transaction" Bundle</button>
        <button id="get-fhir-bundle2" class="btn btn-primary" onclick="showFHIRResourceBundle2()">Show FHIR DiagnosticReport in "collection" Bundle</button>
        <button id="get-sdc-questionnaire" class="btn btn-primary" onclick="showFHIRSDCQuestionnaire()">Show FHIR SDC Questionnaire</button>
        <button id="get-questionnaire" class="btn btn-primary" onclick="showFHIRQuestionnaire()">Show FHIR Questionnaire</button>
        <button id="get-sdc-response" class="btn btn-primary" onclick="showFHIRSDCResponse()">Show FHIR SDC Questionnaire Response</button>
        <button id="change-columns" class="btn btn-primary" onclick="changeObxObr()">Change OBR/OBX Options</button>
        <button id="merge-dr" class="btn btn-primary" onclick="testMergeDR2LForms()">Merge DiagnosticReport (contained) to LForms (USSGFH)</button>
        <button id="merge-bundle-dr" class="btn btn-primary" onclick="testMergeBundleDR2LForms()">Merge DiagnosticReport (Bundle) to LForms (USSGFH)</button>
        <button id="merge-dr-default-values" class="btn btn-primary" onclick="testMergeDR2LFormsWithDefaultValues()">Merge DiagnosticReport (contained) to LForms (Default Values)</button>
        <button id="merge-qr" class="btn btn-primary" onclick="testMergeQR2LForms()">Merge QuestionnaireResponse to LForms (USSGFH)</button>
        <button id="merge-qr-cwe" class="btn btn-primary" onclick="testMergeQR2LForms_CWE()">Merge QuestionnaireResponse to LForms (Full-Featured, w/ CWE user data)</button>
        <button id="test" class="btn btn-primary" onclick="testSearchOnFHIRServer()">Search on FHIR Server</button>

      </div>
    </div>

    <br><br>
    <wc-lhc-form id='test-form'></wc-lhc-form>

  </div>

    <!-- <script src="../bower_components/angular-file-upload/dist/angular-file-upload.min.js"></script> -->

    <script type="text/javascript">

      async function loadJsonFromUrl(url) {
        return await fetch(url).then( 
          response => response.json());
      }

      async function displayForm(formUrl) {
        let testForm = document.getElementById('test-form');
        let formJson = await loadJsonFromUrl(formUrl);        
        testForm.lfData = formJson;
      }

      const testForms = [
        {text: 'USSG-FHT, (with mock-up items for skip logic demo)', id: 'FHTData'},
        {text: 'USSG-FHT, (with mock-up items for horizontal layout demo)', id: 'horizontalFHTData'},
        {text: 'Glasgow Coma Score (with score rules)', id: 'glasgow'},
        {text: 'Full-Featured Demo', id: 'allInOne'},
        {text: 'Form Builder created test form', id: 'formBuilder'},
        {text: 'Minimum Data Set - version 3.0', id: 'MDS3'},
        {text: 'Form With User Data', id: 'formWithUserData'},
        {text: 'Form With User Data, hasSavedData=true', id: 'formWithUserData', options: {hasSavedData: true} },
        {text: 'RxTerms Demo', id: 'rxTerms'},
        {text: 'displayControls (answerLayout and questionLayout)', id: 'displayControlsDemo'},
        {text: 'Matrix Layout, single selection', id: 'matrixLayout2'},
        {text: 'Matrix Layout, multiple selections', id: 'matrixLayout'},
        {text: "Validation Test", id: "validationTestForm"},
        {text: "A form that has a question contains a question or a section", id: "questionInQuestion"},
        {text: "HL7 Genetic Test Panel for Simple Variants", id: "genetic"},
        {text: "HL7 Genetic Test Panel for Simple Variants (table version)", id: "genetic2"},
        {text: "Fields with default answers", id: "defaultAnswerForm"},
        {text: "PROMIS item bank - social isolation - version 2.0", id: "promis"},
        {text: "Master HL7 genetic variant reporting panel (2017-06-06)", id: "newGenetic"},
        {text: "A Form with two TOTALSCORE fields", id: "twoTotalScore"},
        {text: "Vital signs, weight, height, head circumference, oximetry, BMI, & BSA panel", id: "vitalSign"},
        {text: "Items with QTY data type", id: "QTYDemo"},
        {text: 'New Test Form: skiplogic, autocomplete, horizontal layout', id: 'new-test-form'},
        {text: 'validation', id: 'new-validation-form'},
      ];

      function loadFormList() {
        let formList = document.getElementById("form-list");
        testForms.forEach(form => {          
          let option = document.createElement("option");
          option.text = form.text;
          option.value = form.id; 
          formList.add(option);
        })
      }

      function useForm() {
        let formList = document.getElementById("form-list");
        let fhirVersion = document.getElementById("fhirVersion");

        if (formList.value) {
          displayForm("/data/form-data/" + formList.value + ".json")
        }
      };

      loadFormList();

    </script>

<!-- <script
src="https://clinicaltables.nlm.nih.gov/lforms-versions/25.1.1/fhir/R4/lformsFHIR.min.js"></script> -->

  </body>
</html>
